[{"url":"/2022/10/20/vbscript/","content":"#### 方法1调用方法2\n\n```vbscript\npublic Function ExecuteParamSql(ByVal sql,ByVal params)\n    Dim objRs,cmd,param\n    On Error REsume Next\n        SQLCODE = 0\n        ra = -1\n        Set cmd = CreatObject(\"ADODB.Command\")'创建执行面向数据库的一次简单查询对象\n        cmd.CommandText = sql'可设置或返回一个字符串，该字符串包含一个 provider 命令，比如SQL语句表名称一个相对 URL、或者一个存储过程调用。\n    cmd.CommandType = 1'返回一个类型\n    \tfor Each param In params\t\t\t\t 'paramter依赖于命令对象使用\n        \tCreateParamter cmd,param,1,empty,empty'paramter只能存储单个参数信息所以每次循环\n        '对象名，参数，传入1，  \n        Next\n        cmd.ActiveConnection =dbConn\n        cmd.Execute ra  '取得sql运行变更件数\n        Set cmd = Nothing\n        if Err.Number <> 0 Then  '错误处理\n            OnsqlError sql,params\n        End If\n        Err.Clear\n    On Error Goto 0\n    ExecuteParamSql = ra\nEnd Function\n    \n    \n```\n\n##### 方法2 执行带参数的sql语句查询先要将参数数据类型进行数据转换\n\n```vbscript\npublic Sub CreateParameter(ByVal cmd,ByVal value,ByVal direction,ByVal name,ByVal size)\n    Dim param\n    Set param = cmd.CreateParamter()\n    if Not IsEmpty(name) Then\n        param.Name = name\n    End IF\n    param.Value = value\n    param.Directoin = direction\n    Select Case  CheckType(value)\n    Case vbString    'param储存单个信息使用参数在命令执行前来改变命令的某些细节比如先将数据类型和ado访问数据库的类型进行统一转型\n        para.Type =202\n        if IsEmpty(size) Then\n            param.Size = Len(value)\n            If param.Size = 0 Then\n                param.Size =1\n            End If\n        Else\n            param.Size = size\n        End If\n    Case vbInteger,vbLong,vbByte\n        param.Type = 5\n    Case vbSingle,vbDouble,14\n        param.Type = 5\n    Case vbDate\n        param.Type =135\n    Case vbBoolean\n        param.Type =11\n    Case vbCurrency\n        param.Type =6\n    Case vbEmpty,vbNull\n        param.Type =0\n    Case Else\n        param.Type =200\n    End Select\n    cmd.Parameters.Append param   '将对象追加到集合\nEnd Sub\n        \n        \n            \n            \n    \n    \n    \n        \n```\n\n"},{"url":"/2022/10/20/工具(VS code 2012)/","content":"## 1，创建项目\n\n## ![手顺1](http://algorhythnn.jp/blg/wp/wp-content/uploads/2013/11/vbs-debug-use-visual_studio2010_st01.png)\n\n![手顺2](http://algorhythnn.jp/blg/wp/wp-content/uploads/2013/11/vbs-debug-use-visual_studio2010_st02.png)\n\n## 2，删除对应文件\n\n![](http://algorhythnn.jp/blg/wp/wp-content/uploads/2013/11/vbs-debug-use-visual_studio2010_st04.png)\n\n![](http://algorhythnn.jp/blg/wp/wp-content/uploads/2013/11/vbs-debug-use-visual_studio2010_st05.png)\n\n![http://algorhythnn.jp/blg/wp/wp-content/uploads/2013/11/vbs-debug-use-visual_studio2010_st06.png](http://algorhythnn.jp/blg/wp/wp-content/uploads/2013/11/vbs-debug-use-visual_studio2010_st06.png)\n\n## 3，打开explore\n\n![](http://algorhythnn.jp/blg/wp/wp-content/uploads/2013/11/vbs-debug-use-visual_studio2010_st07.png)\n\n![](http://algorhythnn.jp/blg/wp/wp-content/uploads/2013/11/vbs-debug-use-visual_studio2010_st08.png)\n\n![](http://algorhythnn.jp/blg/wp/wp-content/uploads/2013/11/vbs-debug-use-visual_studio2010_st09.png)\n\n![](http://algorhythnn.jp/blg/wp/wp-content/uploads/2013/11/vbs-debug-use-visual_studio2010_st10.png)\n\n## 4，创建文件追加\n\n![](http://algorhythnn.jp/blg/wp/wp-content/uploads/2013/11/vbs-debug-use-visual_studio2010_st11.png)\n\n![](http://algorhythnn.jp/blg/wp/wp-content/uploads/2013/11/vbs-debug-use-visual_studio2010_st12.png)\n\n![](http://algorhythnn.jp/blg/wp/wp-content/uploads/2013/11/vbs-debug-use-visual_studio2010_st13.png)\n\n## 5，更改为VBS的debug\n\n![](http://algorhythnn.jp/blg/wp/wp-content/uploads/2013/11/vbs-debug-use-visual_studio2010_st14.png)\n\n![](http://algorhythnn.jp/blg/wp/wp-content/uploads/2013/11/vbs-debug-use-visual_studio2010_st15.png)\n\n![](http://algorhythnn.jp/blg/wp/wp-content/uploads/2013/11/vbs-debug-use-visual_studio2010_st16.png)\n\n![](http://algorhythnn.jp/blg/wp/wp-content/uploads/2013/11/vbs-debug-use-visual_studio2010_st17.png)\n\n![](http://algorhythnn.jp/blg/wp/wp-content/uploads/2013/11/vbs-debug-use-visual_studio2010_st18.png)\n\n![](http://algorhythnn.jp/blg/wp/wp-content/uploads/2013/11/vbs-debug-use-visual_studio2010_st19.png)\n\n![](http://algorhythnn.jp/blg/wp/wp-content/uploads/2013/11/vbs-debug-use-visual_studio2010_st20.png)"}]